<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TranslateGemma 翻译服务</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <span class="logo">🌐</span>
            <h1>TranslateGemma 翻译服务</h1>
        </div>
        <div class="header-right">
            <button id="theme-toggle" class="icon-btn" title="切换主题">🌙</button>
            <a href="/docs" target="_blank" class="btn-api">📚 API文档</a>
        </div>
    </header>

    <main class="container">
        <!-- Model Selection -->
        <section class="section">
            <h2 class="section-title">🤖 选择模型</h2>
            <div class="model-grid" id="model-grid"></div>
        </section>

        <!-- Translation Area -->
        <div class="translation-container">
            <!-- Source -->
            <section class="panel">
                <div class="panel-header">
                    <h3>源文本</h3>
                    <button class="btn-copy" onclick="copySource()">复制</button>
                </div>
                
                <div class="file-upload" id="file-drop">
                    <input type="file" id="file-input" accept=".txt,.md" hidden>
                    <span>📁 拖拽文本文件或点击上传</span>
                </div>

                <div class="lang-selector">
                    <select id="source-lang">
                        <option value="auto">自动检测</option>
                    </select>
                    <button class="btn-swap" onclick="swapLangs()">⇄</button>
                    <select id="target-lang"></select>
                </div>

                <textarea id="source-text" placeholder="输入要翻译的文本..."></textarea>
            </section>

            <!-- Result -->
            <section class="panel">
                <div class="panel-header">
                    <h3>翻译结果</h3>
                    <button class="btn-copy" onclick="copyResult()">复制</button>
                </div>
                <div id="result-text" class="result-area">翻译结果将显示在这里...</div>
            </section>
        </div>

        <!-- Advanced Settings -->
        <details class="section advanced" open>
            <summary class="section-title">⚙️ 高级参数</summary>
            <div class="params-grid">
                <div class="param">
                    <label>Temperature <span id="temp-val">0.0</span></label>
                    <input type="range" id="temperature" min="0" max="2" step="0.1" value="0">
                </div>
                <div class="param">
                    <label>Top-P <span id="topp-val">1.0</span></label>
                    <input type="range" id="top-p" min="0" max="1" step="0.1" value="1">
                </div>
                <div class="param">
                    <label>Top-K <span id="topk-val">0</span></label>
                    <input type="range" id="top-k" min="0" max="100" step="1" value="0">
                </div>
                <div class="param">
                    <label>重复惩罚 <span id="rep-val">1.0</span></label>
                    <input type="range" id="repetition" min="1" max="2" step="0.05" value="1">
                </div>
            </div>
        </details>

        <!-- Action Buttons -->
        <div class="actions">
            <button class="btn btn-primary" onclick="translate()">🚀 翻译</button>
            <button class="btn btn-stream" onclick="translateStream()">⚡ 流式</button>
            <button class="btn btn-clear" onclick="clearAll()">清空</button>
        </div>

        <!-- Progress -->
        <div id="progress" class="progress hidden">
            <div class="progress-bar"><div id="progress-fill"></div></div>
            <span id="progress-text"></span>
        </div>

        <!-- GPU Status -->
        <section class="gpu-status">
            <span class="status-title">🖥️ GPU 状态</span>
            <div class="status-items">
                <span id="gpu-loaded">● 未加载</span>
                <span id="gpu-mem">📊 显存: - / - MB</span>
                <span id="gpu-idle">⏱️ 空闲: 0秒</span>
                <span id="gpu-model">🤖 当前模型: -</span>
                <button class="btn-release" onclick="releaseGPU()">释放显存</button>
            </div>
        </section>
    </main>

    <script src="/static/app.js"></script>
</body>
</html>
